<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Jak na Raspberry Pi zapnout grafické rozhraní a vzdálený přístup? | ALTAIR.blog</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta http-equiv="Content-Language" content="cs-CZ" />
    <meta name="Description" content="Chcete si s Raspberry Pi pohrát víc, než jak vám nabízím v seriálu o projektu Atropa? Můžete povolit grafické rozhraní a zapnout vzdálený přístup přes RDP." />
  </head>
  <body>
    <header>
      <div>
        <a href="/">
          <img src="/Content/Images/logo_onwhite.svg" alt="altair.blog" style="height:100px;" />
        </a>
      </div>
    </header>
    <main>
      <h1>Jak na Raspberry Pi zapnout grafické rozhraní a vzdálený přístup?</h1>
      <section class="article">
        <p>Chcete si s Raspberry Pi pohrát víc, než jak vám nabízím v seriálu o projektu Atropa? Můžete povolit grafické rozhraní a zapnout vzdálený přístup přes RDP.</p>
<h2 id="jak-zapnout-graficke-prostredi">Jak zapnout grafické prostředí?</h2>
<p>Z konzole můžete nastartovat grafické rozhraní příkazem <code>startx</code>. Ale co když chcete, aby vám Raspberry do grafického prostředí rovnou bootovalo?</p>
<p>V takovém případě zadejte příkaz <code>sudo raspi-config</code>. Spustí se vám textové rozhraní, pomocí kterého můžete nastavit řadu paramerů. Mimo jiné tam najdete i volbu <em>Enable boot to Desktop/Scratch</em>:</p>
<p><a href="http://www.aspnet.cz/Files/20150713-raspi_config_1_2.png"><img src="http://www.aspnet.cz/Files/20150713-raspi_config_1_thumb.png" alt="Utilita raspi-config: hlavní menu" title="Utilita raspi-config: hlavní menu" /></a></p>
<p>Po klepnutí na něj si můžete vybrat, zda se má bootovat do textové konzole, grafického prostředí nebo do programovacího jazyka Scratch (což je takový trochu lepší Karel nebo Logo, programovací jazyk pro děti):</p>
<p><a href="http://www.aspnet.cz/Files/20150713-raspi_config_2_2.png"><img src="http://www.aspnet.cz/Files/20150713-raspi_config_2_thumb.png" alt="Utilita raspi-config: nastavení režimu bootu" title="Utilita raspi-config: nastavení režimu bootu" /></a></p>
<p>Po výběru požadovaného typu bootu zvolte <em><Ok></em> a <em><Select></em> a restartuje Rapberry.</p>
<h2 id="jak-zapnout-vzdaleny-pristup">Jak zapnout vzdálený přístup?</h2>
<p>Pokud nechcete na Raspberry pracovat lokálně, ale vzdáleně, hodí se na něm zapnout RDP, na které se pak budete moci připojit z Windows.</p>
<p>Za tímto účelem musíte nainstalovat balíček <em>xrdp</em>, což učiníte z terminálu následujícím příkazem: <code>sudo apt-get install xrdp</code>.</p>
<p>Při snaze rozchodit správně xrdp jsem měl problém s českou klávesnicí. Ačkoliv mi správně fungovala na lokále v textovém i grafickém režimu, přes RDP jsem měl pořád anglické rozložení a nedokázal jsem psát háčky a čárky. Po jistých problémech jsem přišel na řešení.</p>
<p>Připojte se lokálně na konzoli do grafického rozhraní a spusťte terminál (ve kterém vám funguje klávesnice, jakou chcete). Poté spusťte následující příkazy:</p>
<p>sudo xrdp-genkeymap /etc/xrdp/km-0405.ini sudo cp /etc/xrdp/km-0409.ini /etc/xrdp/km-0409.ini.bak sudo xrdp-genkeymap /etc/xrdp/km-0409.ini</p>
<p>První příkaz vezme stávající mapování klávesnice a uloží ho do souboru <code>km-0405.ini</code>. Číslo 0405 je kód pro češtinu (seznam kódů najdete <a href="http://xrdp.sourceforge.net/documents/keymap/rfc1766.html">na webu xrdp</a>). To by samo o sobě mělo stačit, nicméně mně to nepomohlo. Možná proto, že mám anglická Windows a RDP klient reportuje jako jazyk angličtinu. Proto jsem se rozhodl, že českým přepíšu anglické mapování klávesnice, které je v souboru <code>km-0409.ini</code>. Původní nastavení jsem si pro jistotu uložil do <code>km-0409.ini.bak</code> (to dělá druhý příkaz) a pak přegeneroval původní soubor (třetí příkaz). Poté mi xrdp začalo fungovat česky.</p>
<h2 id="jak-se-pripojit-z-windows">Jak se připojit z Windows?</h2>
<p>Pokud se pokusíte připojit s výchozími nastaveními, nebude vám to fungovat, protože xrdp podporuje pouze osmi nebo šestnáctibitovou barevnou hloubku, zatímco výchozí nastavení terminálového klienta je 32 bitů.</p>
<p>Příkazem <code>mstsc</code> spusťte na Windows terminálového klienta a klepněte ve spodní části okna na šipku vedle <em>Show Options</em>. Přepněte se na záložku <em>Display</em> a nastavte jako barevnou hloubku <em>High Color (16 bit)</em>. Můžete také nastavit rozlišení, jaké chcete používat, pokud chcete, aby spojení běželo v okně a ne na plné obrazovce:</p>
<p><a href="http://www.aspnet.cz/Files/20150713-mstsc_2.png"><img src="http://www.aspnet.cz/Files/20150713-mstsc_thumb.png" alt="Nastavení vlastností terminálového klienta" title="Nastavení vlastností terminálového klienta" /></a></p>
<p>Na záložce <em>General</em> zadejte název nebo IP adresu vašeho RPi za a klepněte na <em>Connect</em>. Budete vyzvání k potvrzení, že se chcete připojit pomocí nešifrovaného spojení  a poté se vám zobrazí přihlašovací dialog, kde zadejte své uživatelské jméno a heslo (výchozí je <code>pi</code> a <code>raspberry</code>):</p>
<p><a href="http://www.aspnet.cz/Files/20150713-xrdp_dialog_2.png"><img src="http://www.aspnet.cz/Files/20150713-xrdp_dialog_thumb.png" alt="Přihlašovací dialog xrdp" title="Přihlašovací dialog xrdp" /></a></p>
<p>Poté budete úspěšně připojeni. Na posledním screenshotu vidíte, jak jsem přes terminál připojen na Raspberry, kde běží Midnight Commander, webový prohlížeč a LibreOffice Writer, který jsem nainstaloval z grafického prostředí pomocí Pi Store:</p>
<p><a href="http://www.aspnet.cz/Files/20150713-xrdp_desktop_2.png"><img src="http://www.aspnet.cz/Files/20150713-xrdp_desktop_thumb.png" alt="RPi přes RDP" title="RPi přes RDP" /></a></p>

      </section>
    </main>
    <footer>
      Footer
    </footer>
  </body>
</html>