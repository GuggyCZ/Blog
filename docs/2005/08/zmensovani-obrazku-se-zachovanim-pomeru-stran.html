<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Zmenšování obrázků se zachováním poměru stran | ALTAIR.blog</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta http-equiv="Content-Language" content="cs-CZ" />
    <meta name="Description" content="Za neuvěřitelně ohavné ovšem považuji chování některých systémů, které si rozměry obrázku upraví k obrazu svému, leč nedbají přitom na poměr stran, takže ve výsledku obrázek zdeformují. Přitom postup pro zmenšení obrázku se zachováním poměru stran je jednoduchý." />
    <link rel="stylesheet" type="text/css" href="/content/styles.min.css?sha=138C4DB3727D348756D2D1C5E0CDCE3318398B5E" />
    <link rel="stylesheet" type="text/css" href="/content/fa-5.1.0/css/all.css" />
    <link rel="alternate" type="application/rss+xml" href="/feed.rss" title="RSS Feed" />
  </head>
  <body>
    <header>
      <div>
        <a href="/">
          <img src="/content/images/logo_onblack.svg" alt="altair.blog" style="height:100px;" />
        </a>
      </div>
    </header>
    <nav>
      <ul>
        <li>
          <a href="https://www.rider.cz/" title="Autor: Michal Altair Valášek">
            <i class="fal fa-user"> </i>
          </a>
        </li>
        <li>
          <a href="/archive" title="Archiv článků">
            <i class="fal fa-archive"> </i>
          </a>
        </li>
        <li>
          <a href="/categories" title="Rubriky">
            <i class="fal fa-tags"> </i>
          </a>
        </li>
        <li>
          <a href="/serials" title="Seriály">
            <i class="fal fa-list-alt"> </i>
          </a>
        </li>
        <li>
          <a href="https://www.rider.cz/#contact" title="Kontakt">
            <i class="fal fa-envelope"> </i>
          </a>
        </li>
        <li>
          <a href="https://facebook.com/rider.cz" title="Facebook">
            <i class="fab fa-facebook"> </i>
          </a>
        </li>
        <li>
          <a href="https://twitter.com/ridercz" title="Twitter">
            <i class="fab fa-twitter"> </i>
          </a>
        </li>
        <li>
          <a href="https://github.com/ridercz" title="Github">
            <i class="fab fa-github"> </i>
          </a>
        </li>
        <li>
          <a href="https://ask.fm/ridercz" title="Ask.fm">
            <i class="fal fa-question"> </i>
          </a>
        </li>
      </ul>
    </nav>
    <main>
      <h1>Zmenšování obrázků se zachováním poměru stran</h1>
      <aside class="article-info">
        <ul class="categories">
          <li>
            <a href="/categories/programovani" title="Rubrika">
              <i class="fal fa-tag"> </i>Programování</a>
          </li>
        </ul>
        <div>
          <a href="https://www.rider.cz/">Michal Altair Valášek </a>
          <i class="fal fa-user">​</i>
        </div>
        <div>
          <time datetime="2005-08-16T21:07:04.99+02:00" title="Datum vydání">16. srpna 2005 <i class="fal fa-calendar-alt">​</i></time>
        </div>
      </aside>
      <section class="article-text">
        <p>V mnoha aplikacích je třeba umožnit uživateli, aby nahrál nějaký obrázek. Tato operace je triviální pouze zdánlivě. Ačkoliv pro webdesignéra znalého práce s Photoshopem je řekněme úprava velikosti obrázku či jeho ořez triviální, pro mnoho uživatelů představuje překážku téměř nepřekonatelnou.</p>
<p>K přijímání obrázků do aplikací je třeba přistupovat obezřetně. Že vy, coby autor aplikace, si pod pojmem &quot;ikonka&quot; představíte malý obrázek o rozměrech 40x50 bodů ještě neznamená, že se vám tam uživatel nepokusí nahrát kompletní neupraveno fotografii z digitálu v rozlišení 6 megapixelů.</p>
<p>Jest tedy nutno minimálně ověřovat, co uživatel posílá. A ještě lépe, umožnit mu aby nahrál víceméně cokoliv a nějak si s tím poradit - obrázek operativně zvětšit či zmenšit.</p>
<p>Za neuvěřitelně ohavné ovšem považuji chování některých systémů, které si rozměry obrázku upraví k obrazu svému, leč nedbají přitom na poměr stran, takže ve výsledku obrázek zdeformují. Přitom postup pro zmenšení obrázku se zachováním poměru stran je jednoduchý. Definujeme maximální velikost obrázku jako prostor, do kterého se obrázek musí vejít. Pokud se poměr stran originálního obrázku bude shodovat s poměrem stran maximální velikosti, nastane ideální situace a obrázek bude zcela vyplňovat prostor. Bude-li jiný, je třeba zmenšit obrázek tak, aby se celý vešel do vyhrazeného prostoru a zbytek vyplnit podkladovou barvou (pokud nutně potřebujete pevnou velikost obrázku).</p>
<p>V zájmu ochrany svého estetického cítění před zdeformovanými obrázky zde přikládám příslušný kód:</p>
<pre><code>Public Shared Function ResizeImage(ByRef Source As System.Drawing.Image, ByVal Width As Int32, ByVal Height As Int32) As System.Drawing.Image
    ' Do nothing, if dimensions are correct
    If Source.Width = Width And Source.Height = Height Then Return Source
    ' Get proportional size of image
    Dim W, H As Int32
    If Source.Width &gt;= Source.Height Then
        W = Width
        H = CInt(Source.Height * (Width / Source.Width))
    Else
        W = CInt(Source.Width * (Height / Source.Height))
        H = Height
    End If
    ' Draw new image
    Dim Target As New System.Drawing.Bitmap(Width, Height)
    Dim GPH As System.Drawing.Graphics = System.Drawing.Graphics.FromImage(Target)
    GPH.FillRectangle(Drawing.Brushes.White, 0, 0, Width, Height)
    GPH.CompositingQuality = Drawing.Drawing2D.CompositingQuality.HighQuality
    GPH.SmoothingMode = Drawing.Drawing2D.SmoothingMode.HighQuality
    GPH.InterpolationMode = Drawing.Drawing2D.InterpolationMode.HighQualityBicubic
    GPH.DrawImage(Source, 0, 0, W, H)
    Return Target
End Function
</code></pre>

      </section>
    </main>
    <footer>
      <ul class="logos">
        <li>
          <img src="/content/images/logo_onwhite.svg" alt="altair.blog" style="height:38px;" />
        </li>
      </ul>
      <ul class="text">
        <li>
          Copyright © <a href="https://www.rider.cz/">Michal Altair Valášek</a>, 2003-2018</li>
        <li>
          Powered by <a href="https://www.xml4web.com/">XML4web</a> on <a href="https://www.github.com/">GitHub Pages</a></li>
        <li>
          <a href="/feed.rss" rel="alternate">
            RSS feed <i class="fal fa-rss-square"> </i></a>
        </li>
      </ul>
    </footer>
  </body>
</html>