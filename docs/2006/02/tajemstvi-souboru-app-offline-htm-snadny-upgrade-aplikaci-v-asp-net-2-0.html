<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Tajemství souboru app_offline.htm - snadný upgrade aplikací v ASP.NET 2.0 | ALTAIR.blog</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta http-equiv="Content-Language" content="cs-CZ" />
    <meta name="Description" content="Jak snadno aktualizovat ASP.NET aplikaci, včetně výměny SQL Express databází? Použijte jednoduchý trik se souborem app_offline.htm" />
    <link rel="stylesheet" type="text/css" href="/content/styles.min.css" />
    <link rel="alternate" type="application/rss+xml" href="/feed.rss" title="RSS Feed" />
  </head>
  <body>
    <header>
      <div>
        <a href="/">
          <img src="/content/images/logo_onwhite.svg" alt="altair.blog" style="height:100px;" />
        </a>
      </div>
    </header>
    <main>
      <h1>Tajemství souboru app_offline.htm - snadný upgrade aplikací v ASP.NET 2.0</h1>
      <section class="article">
        <p>Často je potřeba aktualizovat běžící aplikaci. Pokud vám na ni chodí pět lidí za den, není to velký problém, prostě se stará data přepíší novými. Pokud je ale aplikace navštěvovanější, začínají problémy. Soubory jsou zamčené a není možné je přepsat, u větších updatů může dojít ke zmatení aplikace, o uživateli nemluvě a podobně.</p>
<p>Dobrodružné povahy použivající v ostrém provozu <em>user instance</em> SQL Serveru 2005 Express navíc musejí řešit problém s výměnou datových souborů MDF/LDF, k nimž je nemožno se za běhu dostat atd.</p>
<p>Řešení spočívá v souboru <code>app_offline.htm</code>. Pokud v rootu své webové aplikace vytvoříte soubor s tímto názvem, celá .NET aplikace se zastaví. Zruší se její aplikační doména (AppDomain) a v důsledku toho se též odpojí všechny připojené databázové soubory a zruší user instance.</p>
<p>Všechny požadavky na danou aplikaci směřované pak budou zodpovězeny zasláním obsahu tohoto souboru - měli byste do něj tudíž umístit nějakou vysvětlující zprávu v duchu, že právě probíhá aktualizace.</p>
<p>Pokud tento soubor smažete (nebo přejmenujete), při prvním dalším požadavku se aplikace normálně nastartuje.</p>
<p>Tuto funkcionalitu využívá interně i VS 2005 / VWD ve své funkci &quot;copy project&quot; potažmo &quot;publish web site&quot;.</p>
<p>Až někdy přijdete na ASPNET.CZ a uvidíte <a href="/_app_offline.htm">tento text</a>, tak vězte, že je způsoben právě tím, že jsem při aktualizaci takto aplikaci dočasně zakázal.</p>

      </section>
    </main>
    <footer>
      Footer
    </footer>
  </body>
</html>